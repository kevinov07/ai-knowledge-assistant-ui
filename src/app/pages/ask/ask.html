<div class="flex h-screen min-h-0 bg-background overflow-hidden">
  <app-collections-sidebar
    [collections]="collections"
    [activeCollectionId]="activeCollectionId"
    [isCollapsed]="sidebarCollapsed"
    [pagination]="collectionsPagination"
    (toggleCollapse)="onToggleSidebar()"
    (goHome)="onGoHome()"
    (selectCollection)="onSelectCollection($event)"
    (createCollection)="onCreateCollection()"
    (deleteCollection)="onDeleteCollection($event)"
    (pageChange)="onCollectionsPageChange($event)">
  </app-collections-sidebar>

  <div class="flex min-h-0 flex-1 flex-col min-w-0 overflow-y-auto overflow-x-hidden">
    @if (activeCollection) {
      <app-collection-view
        [collection]="activeCollection"
        [isLoading]="isLoading"
        (updateCollection)="onUpdateCollection($event)"
        (uploadRequest)="onUploadFiles($event)"
        (sendMessage)="onAskQuestion($event)"
        (back)="onBack()"
        (deleteDocument)="onDeleteDocument($event)">
      </app-collection-view>
    } @else {
      <app-welcome-view
        [collections]="collections"
        (selectCollection)="onSelectCollection($event)"
        (createCollection)="onCreateCollection()">
      </app-welcome-view>
    }
  </div>

  <app-create-collection-dialog
    [(open)]="showCreateDialog"
    (createCollection)="onCreatedCollection($event)">
  </app-create-collection-dialog>

  @if (pendingPrivateCollection) {
    <app-private-code-dialog
      [open]="!!pendingPrivateCollection"
      [collectionName]="pendingPrivateCollection.name"
      [errorMessage]="privateCodeError"
      [isLoading]="isUnlocking"
      (openChange)="onPrivateDialogClose($event)"
      (submitCode)="onSubmitPrivateCode($event)"
      (clearError)="privateCodeError = null">
    </app-private-code-dialog>
  }

  @if (collectionToDelete) {
    <app-confirm-dialog
      [open]="showDeleteConfirm"
      [title]="'Delete Collection'"
      [message]="deleteConfirmMessage"
      [confirmText]="'Delete'"
      [cancelText]="'Cancel'"
      [variant]="'danger'"
      (openChange)="showDeleteConfirm = $event"
      (confirm)="onConfirmDelete()"
      (cancel)="onCancelDelete()">
    </app-confirm-dialog>
  }
</div>
