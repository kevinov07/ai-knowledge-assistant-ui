<div class="h-screen flex bg-background overflow-hidden">
  <app-collections-sidebar
    [collections]="collections"
    [activeCollectionId]="activeCollectionId"
    [isCollapsed]="sidebarCollapsed"
    (toggleCollapse)="onToggleSidebar()"
    (goHome)="onGoHome()"
    (selectCollection)="onSelectCollection($event)"
    (createCollection)="onCreateCollection()"
    (deleteCollection)="onDeleteCollection($event)">
  </app-collections-sidebar>

  <div class="flex-1 flex flex-col min-w-0">
    @if (activeCollection) {
      <app-collection-view
        [collection]="activeCollection"
        [isLoading]="isLoading"
        (updateCollection)="onUpdateCollection($event)"
        (uploadRequest)="onUploadFiles($event)"
        (sendMessage)="onAskQuestion($event)"
        (back)="onBack()">
      </app-collection-view>
    } @else {
      <app-welcome-view
        [collections]="collections"
        (selectCollection)="onSelectCollection($event)"
        (createCollection)="onCreateCollection()">
      </app-welcome-view>
    }
  </div>

  <app-create-collection-dialog
    [(open)]="showCreateDialog"
    (createCollection)="onCreatedCollection($event)">
  </app-create-collection-dialog>

  @if (pendingPrivateCollection) {
    <app-private-code-dialog
      [open]="!!pendingPrivateCollection"
      [collectionName]="pendingPrivateCollection.name"
      [errorMessage]="privateCodeError"
      [isLoading]="isUnlocking"
      (openChange)="onPrivateDialogClose($event)"
      (submitCode)="onSubmitPrivateCode($event)"
      (clearError)="privateCodeError = null">
    </app-private-code-dialog>
  }
</div>
